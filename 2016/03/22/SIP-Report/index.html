<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      Social Impact Project | Yunong Cao 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="Yunong Cao">
    
    

    <meta name="description" content="Detect Risky Violations Correlated to Food Poisoning Incidents1. IntroductionIn New York City, there are over 24,000 restaurants and food retailers are constantly welcoming customers from all over the">
<meta property="og:type" content="article">
<meta property="og:title" content="Social Impact Project | Yunong Cao">
<meta property="og:url" content="http://yunongcao.github.io/2016/03/22/SIP-Report/index.html">
<meta property="og:site_name" content="Yunong Cao">
<meta property="og:description" content="Detect Risky Violations Correlated to Food Poisoning Incidents1. IntroductionIn New York City, there are over 24,000 restaurants and food retailers are constantly welcoming customers from all over the">
<meta property="og:image" content="http://yunongcao.github.io/img/bar.png">
<meta property="og:updated_time" content="2016-04-01T18:32:04.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Social Impact Project | Yunong Cao">
<meta name="twitter:description" content="Detect Risky Violations Correlated to Food Poisoning Incidents1. IntroductionIn New York City, there are over 24,000 restaurants and food retailers are constantly welcoming customers from all over the">
<meta name="twitter:image" content="http://yunongcao.github.io/img/bar.png">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">Yunong Cao</a></h1>
        <hr class="panel-cover__divider" />

        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">Blog</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">About</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">Archive</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



<nav class="cover-navigation navigation--social">
  <ul class="navigation">

    
      <!-- Github -->
      <li class="navigation__item">
        <a href="https://github.com/yunongcao" title="Huno on GitHub">
          <i class='icon icon-social-github'></i>
          <span class="label">GitHub</span>
        </a>
      </li>
    

    <!-- China social icon -->
    <!--
    
      <li class="navigation__item">
        <a href="" title="">
          <i class='icon cs-icon-douban'></i>
          <span class="label">Douban</span>
        </a>
      </li>

      <li class="navigation__item">
        <a href="" title="">
          <i class='icon cs-icon-weibo'></i>
          <span class="label">Weibo</span>
        </a>
      </li>

    -->



  </ul>
</nav>



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">Social Impact Project</h1>

    

    <div class="post-meta">
      <time datetime="2016-03-22" class="post-meta__date date">2016-03-22</time> 

      <span class="post-meta__tags tags">

          

          
             &#8226; 标签:
            <font class="tags">
              <a class="tags-link" href="/tags/USI-SIP-DOHMH-311/">USI SIP DOHMH 311</a>
            </font>
          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <h2 id="Detect-Risky-Violations-Correlated-to-Food-Poisoning-Incidents"><a href="#Detect-Risky-Violations-Correlated-to-Food-Poisoning-Incidents" class="headerlink" title="Detect Risky Violations Correlated to Food Poisoning Incidents"></a>Detect Risky Violations Correlated to Food Poisoning Incidents</h2><h3 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h3><p>In New York City, there are over 24,000 restaurants and food retailers are constantly welcoming customers from all over the world. Meanwhile, there are over 6,000 people end up hospitalized for foodborne illness in New York City every year<sup>2</sup>. Although the exact proportion of foodborne illness which caused by restaurants is unknown, it is found that consumption of food prepared outside the home has been linked to an increased risk of sporadic foodborne diseases<sup>1</sup>. Therefore, food safety in restaurants turns out to be a problem that cannot be neglected. In an effort to better improve the food safety and the transparency of inspection, the Department of Health and Mental Hygiene in New York launched a letter-grade system to indicate the performance of restaurants in health and environmental perspectives in 2010.<br>DOHMH’s inspection result of each restaurant is open to public and residents in the city are informed promptly about the condition of the restaurants. Although the existing system has urged the restaurants and food retailers to improve, there is still some food poisoning incidents happen and they even happen in those food retailers that received A grades. For example, Bella Blu, an Italian restaurant in Upper East Side was subject to a food poisoning incident in mid January<sup>3</sup> after it had received an A grade during the inspection in late October last year. Hence, we believed there was still space for more improvement based on the existing grading mechanism to control food health and public safety and some violations in the current grading system might need more emphasis during the guidance and inspection. </p>
<h3 id="2-Objective-and-Goal"><a href="#2-Objective-and-Goal" class="headerlink" title="2. Objective and Goal"></a>2. Objective and Goal</h3><p>In this project, we wanted to find those violations that have been underestimated but have a high risk to cause foodborne illness by linking and mining the 311 food poisoning report and DOHMH restaurant inspection record. Specifically, through cross-referencing the restaurants referred in the 311 food poisoning report and DOHMH inspection results, a list of restaurants (our study area) that have food poison reports against them would be generated. Then based on the list, we would like to identify the most common violations and hopefully discover the patterns of violations that had committed by these restaurants from the restaurant inspection results. The final product would be a list of such risky violations that need to draw more attention.<br>For example, if we observe violation A frequently appears in the inspection record of the restaurants in our list, it might imply that A is highly correlated to foodborne illness. In addition, if we find that violation A is non-critical but repeatedly occurs with violation C, D and E, it will provide evidence to show that there are several critical or non-critical violations that occur along with violation A and food inspectors and the administrators should look into and provide more guidance on this violation. Also, DOHMH might consider taking this violation in the critical category. Such actions could improve the grading mechanism by categorizing them more reasonably and better prevent the food poisoning from the food production process.</p>
<h3 id="3-Data-Cleaning-and-Transformation"><a href="#3-Data-Cleaning-and-Transformation" class="headerlink" title="3. Data Cleaning and Transformation"></a>3. Data Cleaning and Transformation</h3><p>DOHMH restaurant inspection data and 311 food poisoning data was the two major datasets used in this project. Since the whole 311 data on NYC OpenData website was too big, we first narrowed down the feature space of the 311 dataset by just keeping the attributes we need for the analysis like the date of occurrence, types of events, number of people involved, restaurant’s name, location and etc. in order to reduce the size of data to be processed. These are done using the filter function in NYC OpenData website.<br>For DOHMH restaurant inspection data, we used the same process and kept the restaurant name, cuisine type, address, zip code, borough, violation codes, score, letter grade and inspection date.<br>Furthermore, some entries that do not have either score or letter grade are eliminated from the dataset.<br>Since we wanted to cross-reference the restaurants in both dataset by geocoding the location of them, we preprocessed the street names via Python. In this case, we changed the abbreviation words “ST”, “AV”, “RD” to “STREET”, “AVENUE”, “ROAD”, and removed the hyphen in the words. </p>
<h3 id="4-Analytical-methods"><a href="#4-Analytical-methods" class="headerlink" title="4. Analytical methods"></a>4. Analytical methods</h3><h4 id="4-1-Find-the-validated-food-poisoning-incidents-in-311-data"><a href="#4-1-Find-the-validated-food-poisoning-incidents-in-311-data" class="headerlink" title="4.1 Find the validated food poisoning incidents in 311 data:"></a>4.1 Find the validated food poisoning incidents in 311 data:</h4><p>The first step of our analysis is to found the food poisoning incidents in the 311 dataset and we did this by filtering a few of features in the data. The complaint type and descriptor were first limited to just “food poisoning” and “3 or more”, respectively since we only wanted to investigate the foodborne illness incidents caused during the food preparation process and we wanted to exclude the non-related or isolated reports such as food allergy. To make sure the report was confirmed by DOHMH to be a case of food poisoning, the data was then narrowed down so that the resolution column only contained one the following categories:  </p>
<ul>
<li>The DOHMH has investigated the complaint and issued a Notice of Violation. The agency will continue to monitor.</li>
<li>The Department of Health and Mental Hygiene has investigated the complaint.  Owner/manager ordered to abate nuisance.  Violations of rules and regulations issued and fines may be levied as appropriate.  </li>
<li>The Department of Health and Mental Hygiene has investigated the complaint. Violations of rules and regulations issued resulting in the closure of the establishment by DOHMH. The establishment will be re-opened if the violations are corrected.  </li>
<li>The facility you reported will receive a sanitary inspection.</li>
</ul>
<h4 id="4-2-Cross-reference-the-restaurants-in-both-datasets"><a href="#4-2-Cross-reference-the-restaurants-in-both-datasets" class="headerlink" title="4.2 Cross-reference the restaurants in both datasets:"></a>4.2 Cross-reference the restaurants in both datasets:</h4><p>In the previous step, we got a list of reports that had received food poisoning complaints and we wanted to link them with the restaurant inspection data. This was achieved by merging these two datasets using geographical information such as address and coordinates (longitude, latitude) in them. Although the DOHMH restaurant inspection record data did not provide us with intuitive location, we found a table which had information with regard to the geocoded restaurant locations in the DOHMH restaurant inspection record data.<br>Considering that the fact that the restaurants and the places where food poisoning complaints happened cannot match perfectly as the longitude and latitude of 311 complaints have random noise around the exact location, we developed our own algorithm to cross-reference the location in the two datasets by checking whether the restaurant’s address agree with the complaints’ address and validate the closeness of two coordinates simultaneously. Finally, using the unique CAMIS code for each restaurant identified, we were able to subset the DOHMH restaurant inspection data and that was the dataset we would use for study in the next step. (We referred this dataset to be study data in this report)  </p>
<h4 id="4-3-Analyze-and-item-set-mining-the-study-data"><a href="#4-3-Analyze-and-item-set-mining-the-study-data" class="headerlink" title="4.3 Analyze and item set mining the study data:"></a>4.3 Analyze and item set mining the study data:</h4><p>An descriptive data analysis was conducted on the dataset such as checking the size of data and finding the most frequent violations in the dataset. The violation code in the dataset was then grouped by CAMIS code as well as inspection date and turned them to a nested list for pattern finding purposes via Python Pandas.<br>In order to discover the patterns of violations committed by these restaurants, we applied association rule learning technique to the nested list in that association rule learning was good at identify strong rules discovered in databases using some measures of interestingness. For the algorithm for association rule learning, we chose RElim algorithm simply because it computationally outperformed SaM and FP-growth algorithm and could be conveniently realized in Python.</p>
<h3 id="5-Ethical-and-Privacy-Considerations"><a href="#5-Ethical-and-Privacy-Considerations" class="headerlink" title="5. Ethical and Privacy Considerations"></a>5. Ethical and Privacy Considerations</h3><p>Overall, our project generated little personal information and ethical issues. The restaurants with food poisoning report were exposed to the public. On the other hand, the reporters’ identities were well-protected by NYC websites since the dataset did not contain any information about the reporters.<br>However, during the process of matching the locations from 311 food poisoning data to DOHMH restaurant inspection data, we had noticed that some locations reported were not quite accurate. Since there was no restaurant name attribute in 311 reports, restaurants’ information might be mismatched. Reporter might provide the wrong information about the incident occurrence. This series of issues could influence some restaurants’ reputations as well.<br>The result, the list of the restaurants, might give people the impression of discriminating some types of cuisine in the city. For example, some cuisines’ food processing was quite special but definitely a violation based on the inspection criteria. DOHMH should adjust its grading criteria to accommodate the special food processing of certain types of cuisines.</p>
<h3 id="6-Data-Outputs-and-Results"><a href="#6-Data-Outputs-and-Results" class="headerlink" title="6. Data Outputs and Results"></a>6. Data Outputs and Results</h3><p>After the cross-referencing, we successfully find out 513 restaurants that had both at least one record of food poisoning complaint and inspection history on the 311 data and DOHMH restaurant inspection record, respectively. By counting the unique violation, we found that general violation 10F: “Equipment not easily movable or sealed to floor, adjoining equipment, adjacent walls or ceiling. Aisle or workspace inadequate.” to be the most common violation (appeared 1752 times) followed by general violation 08A: “Facility not vermin proof. Harborage or conditions conducive to attracting vermin to the premises and/or allowing vermin to exist.” (appeared 1363 times) and critical violation 02G: “Cold food item held above 41º F (smoked fish and reduced oxygen packaged foods above 38 ºF) except during necessary preparation” (appeared 1207 times). This result indicated that although violation 10F and 02G were non-critical, they should be seriously taken care of since they were closely correlated to food poisoning risks. According to the analysis, violations that closely correlated to foodborne illness were: 10F, 08A, 02G, 04L, 10B, 06D.  </p>
<p><img src="/img/bar.png" alt="bar" title="Logo Title Text 2"></p>
<p><strong>Figure 1. The most frequent violation codes in the study data</strong>  </p>
<p>Beyond that, we found a pattern with respect to violation 10F through association rule learning (ARL), which was that there were several critical and general violations that occur along with violation 10F and they were:  </p>
<ul>
<li>02G  (Critical): cold storage violation, “Cold food item held above 41º F (smoked fish and reduced oxygen packaged foods above 38 ºF) except during necessary preparation”.   </li>
<li>04l (Critical): “Evidence of rats or live rats present in facility’s food and/or non-food areas”.  </li>
<li>06C (Critical): “Food not protected from potential source of contamination during storage, preparation, transportation, display or service”.  </li>
<li>08G (General): “ Facility not vermin proof. Harborage or conditions conducive to vermin exist”.  </li>
</ul>
<table>
<thead>
<tr>
<th>Rule</th>
<th>Confidence</th>
<th>Rule</th>
<th>Category</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0.91</td>
<td>02G ==&gt; 10F</td>
<td>Critical</td>
</tr>
<tr>
<td>2</td>
<td>0.82</td>
<td>04l ==&gt; 10F</td>
<td>Critical</td>
</tr>
<tr>
<td>3</td>
<td>0.72</td>
<td>06C ==&gt; 10F</td>
<td>Critical</td>
</tr>
<tr>
<td>4</td>
<td>0.71</td>
<td>08G ==&gt; 10F</td>
<td>General </td>
</tr>
</tbody>
</table>
<p><strong>Table 1. Result of association rule learning</strong>  </p>
<p>The average confidence level between violation 10F and the violations group above is approximately 0.7 according to the result of ARL, which means about 70% of the violation 10F in each inspection accompanied by the violations group above. This result indicated that 10F is a violation, though non-critical, might trigger many other critical violations. Based on this result, we suggested this violation should be included in the critical category because of its recurrent nature; and due to the fact that it might be the root cause for many other critical violations. We also suggested that administrators in DOHMH should lay more emphasis on the guidance to correct general violation 10F.<br>There were other similar patterns with confidence level above 0.67 found by ARL. Nevertheless, since violations with respect to those patterns were all critical ones, we did not address them in this report.  </p>
<h3 id="7-Reproducibility"><a href="#7-Reproducibility" class="headerlink" title="7. Reproducibility"></a>7. Reproducibility</h3><p>This project is fully reproducible and some data as well as all scripts used for data treatments are available on the project repository on GitHub. However, several reasons might result in the difference of the final result.<br>First, due to the limitation of file size of GitHub, the 311 reports and DOHMH restaurant inspection data were not uploaded to the project repository. Although they are accessible on the NYC OpenData website, the data on that would be different from the one used in this project since they are real-time. To retrieve the same dataset as we used, filter both datasets by created date or inspection date to be from July 2010 to December 2015.<br>Second, changing parameters in geocoding algorithm we used might affect the performance of cross-referencing process, which would also lead to a change in the result. A different geocoding method such as using GeoClient API by DoITT could also lead to a different result.<br>Third, we used pymining library for conducting ARL. Using a newer edition of the library or using other libraries could affect the result of ARL. Nonetheless, this should only result in minor differences as it comes to the final result.</p>
<h3 id="8-Suggested-Next-Steps"><a href="#8-Suggested-Next-Steps" class="headerlink" title="8. Suggested Next Steps"></a>8. Suggested Next Steps</h3><p>Our analysis provided a list of violation codes that needs to draw more attention, but we did not find a method to differentiate the risk of those violations. For the next step, we suggested more item set mining techniques to be applied on the dataset such as frequent item set mining. After doing such analysis, one might consider constructing a scientific metric to quantify the risk for each violation code and assigned an appropriate weight on it. Finally, DOHMH could leverage such weights as a reference to improve and refine its grading mechanism by using a weighting algorithm rather than just have three categories for violations as the one used in the current grading system<sup>4</sup>.<br>We also suggested that one could investigate the relationship between violation codes and time so that the weight of each violation could fluctuate as a function of time according to the risk of that violation during the inspection period.  </p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference:"></a>Reference:</h3><ol>
<li>Angulo, F. J., &amp; Jones, T. F. (2006). Eating in restaurants: a risk factor for foodborne disease?.Clinical Infectious Diseases, 43(10), 1324-1328.  </li>
<li>Community Health Survey. (2011). New York City Department of Health and Mental Hygiene. New York, NY.  </li>
<li>Mongelli, L., &amp; Eustachewich, L. (2016, January 19). Birthday girl: Eatery’s meatballs left me ‘sick as a dog’. Retrieved March 14, 2016, from <a href="http://nypost.com/2016/01/19/birthday-girl-uws-eaterys-meatballs-left-me-sick-as-a-dog/" target="_blank" rel="external">http://nypost.com/2016/01/19/birthday-girl-uws-eaterys-meatballs-left-me-sick-as-a-dog/</a>  </li>
<li>NYC Health Department. (2010, December). What to Expect When You’re Inspected: A Guide for Food Service Operators. Retrieved March, 2016, from <a href="http://www.nyc.gov/html/doh/downloads/pdf/rii/blue-book.pdf#page=9" target="_blank" rel="external">http://www.nyc.gov/html/doh/downloads/pdf/rii/blue-book.pdf#page=9</a></li>
</ol>

  </section>

  
  
</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | 由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno">Huno</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
