<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      Explore Empty Taxis Problem in NYC | Yunong Cao 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="Yunong Cao">
    
    

    <meta name="description" content="1. IntroductionWith the rapid urbanization progress around the world, traffic issue has drawn more and more attention regarding the city’s sustainable development. The traffic condition in New York Ci">
<meta property="og:type" content="article">
<meta property="og:title" content="Explore Empty Taxis Problem in NYC | Yunong Cao">
<meta property="og:url" content="http://yunongcao.github.io/2016/09/12/Empty-Taxis/index.html">
<meta property="og:site_name" content="Yunong Cao">
<meta property="og:description" content="1. IntroductionWith the rapid urbanization progress around the world, traffic issue has drawn more and more attention regarding the city’s sustainable development. The traffic condition in New York Ci">
<meta property="og:image" content="http://yunongcao.github.io/img/phase1.png">
<meta property="og:image" content="http://yunongcao.github.io/img/phase2.png">
<meta property="og:image" content="http://yunongcao.github.io/img/phase3.png">
<meta property="og:image" content="http://yunongcao.github.io/img/by_day.png">
<meta property="og:image" content="http://yunongcao.github.io/img/by_hour.png">
<meta property="og:image" content="http://yunongcao.github.io/img/taxi_zone.png">
<meta property="og:image" content="http://yunongcao.github.io/img/all_day.png">
<meta property="og:image" content="http://yunongcao.github.io/img/rush_hour.png">
<meta property="og:image" content="http://yunongcao.github.io/img/rush_hour.png">
<meta property="og:updated_time" content="2016-09-12T12:54:29.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Explore Empty Taxis Problem in NYC | Yunong Cao">
<meta name="twitter:description" content="1. IntroductionWith the rapid urbanization progress around the world, traffic issue has drawn more and more attention regarding the city’s sustainable development. The traffic condition in New York Ci">
<meta name="twitter:image" content="http://yunongcao.github.io/img/phase1.png">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">Yunong Cao</a></h1>
        <hr class="panel-cover__divider" />

        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">Blog</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">About</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">Archive</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



<nav class="cover-navigation navigation--social">
  <ul class="navigation">

    
      <!-- Github -->
      <li class="navigation__item">
        <a href="https://github.com/yunongcao" title="Huno on GitHub">
          <i class='icon icon-social-github'></i>
          <span class="label">GitHub</span>
        </a>
      </li>
    

    <!-- China social icon -->
    <!--
    
      <li class="navigation__item">
        <a href="" title="">
          <i class='icon cs-icon-douban'></i>
          <span class="label">Douban</span>
        </a>
      </li>

      <li class="navigation__item">
        <a href="" title="">
          <i class='icon cs-icon-weibo'></i>
          <span class="label">Weibo</span>
        </a>
      </li>

    -->



  </ul>
</nav>



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">Explore Empty Taxis Problem in NYC</h1>

    

    <div class="post-meta">
      <time datetime="2016-09-12" class="post-meta__date date">2016-09-12</time> 

      <span class="post-meta__tags tags">

          

          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <h3 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h3><p>With the rapid urbanization progress around the world, traffic issue has drawn more and more attention regarding the city’s sustainable development. The traffic condition in New York City is particularly severe and the empty taxis on streets have worsened the traffic congestion, especially in rush hours. In this project, we want to explore the roaming empty yellow taxi conditions in NYC by applying big data techniques and we believe the discovery of empty taxi distribution may help alleviate the traffic burden and change the terrible traffic condition in NYC.</p>
<h3 id="2-Data"><a href="#2-Data" class="headerlink" title="2. Data"></a>2. Data</h3><ul>
<li>The taxi data used in this project were provided by Chris Whong, including all trip records of NYC yellow taxis in 2013. The attributes used and description of them were listed below:<ul>
<li>Tpep_pickup_datetime: date and time when the passenger was engaged</li>
<li>Tpep_dropoff_datetime: date and time when the passenger was disengaged</li>
<li>Pickup_longitude/Dropoff_latitude: where the passenger was engaged</li>
<li>Dropoff_longitude/Dropoff_latitude: where the passenger was disengaged</li>
<li>Medallion: the ID of each taxi<br><br>     </li>
</ul>
</li>
<li>The geometry data of taxi zones (in both geojson and shapefile formats) were obtained from CartoDB (provided by Todd W. Schneider). Attributes used are the name and area of each taxi zone.</li>
</ul>
<h3 id="3-Methodology"><a href="#3-Methodology" class="headerlink" title="3. Methodology"></a>3. Methodology</h3><p>We chose Spark to conduct the big data processing for this project. First of all, we manipulated the taxi datasets using map and reduce functions. Next, we built a network model of taxi zones using pysal to find the potential path of empty taxi. Finally, the zones that empty taxis passed through were found using Rtree.<br>In addition, we also visualized the geographical and temporal distribution of empty taxis in NYC.</p>
<p><strong>Phase 1</strong></p>
<p>First, we used the <em>ReduceByKey</em> function to aggregate the data into keyvalue pairs with date and medallion as key, while the records (pick up location, pick up time, drop off location, and drop off time) of all trips of that medallion on that day as value.<br>Second, a <em>Reduce</em> function was used to merge all trip records of the same key into a whole list. Also, a pipe was put in front of each drop off location.<br>Third, we used a <em>Map</em> function to select all drop off and next pick up pairs between two pipes, and simply dropped the first pick up location as well as the last drop off location.<br>Eventually, a <em>FlatAsMap</em> function was used to separate each drop off and next pick up pair.<br>In this project, a taxi is considered empty when the time between dropoff and next pickup is longer than 600 seconds. Therefore, in the final step of this phase, we filtered all key value pairs so that only the trips of empty taxis were left.</p>
<p><strong>Phase 2</strong></p>
<p>The target of phase 2 is to build a network among the taxi zones. The nodes of the network were generated by finding centroids of each polygon area form the taxi zones data. In order to find edges, we used the function of buildContiguity with ‘queen’ (A queen weights matrix defines a location’s neighbors as those with either a shared border or vertex (in contrast to a rook weights matrix , which only includes shared borders). Queen matrices are contiguitybased matrices with .gal extensions in GeoDa (as opposed to distancebased weights ))as the criterion in the Pysal package. Also, we manually added edges for taxi zones that are connected by bridges.</p>
<p><strong>Phase 3</strong><br>RTree was used to apply the keyvalue pairs (output of Phase 1) to the geojson file in order to get the taxi zones where the latitude and longitude of drop off/pick up were located. Next, the shortest path between the drop off zone and next pick up zone was calculated based on<br> the network model built in Phase 2. Last, functions of <em>FlatAsMap</em>, <em>Map</em> and <em>Reduce</em> were used to generate the total number of empty taxis in each taxi zone for different hours in a day and different days of a week.</p>
<p>The flowcharts of the three phases described above were showed in Figure 1, 2 and 3, respectively.</p>
<p><img src="/img/phase1.png" alt="phase1" title="phase1"></p>
<p><strong>Figure 1: Workflow of Phase 1</strong> </p>
<p><img src="/img/phase2.png" alt="phase2" title="phase2"></p>
<p><strong>Figure 1: Workflow of Phase 2</strong> </p>
<p><img src="/img/phase3.png" alt="phase3" title="phase1"></p>
<p><strong>Figure 3: Workflow of Phase 1</strong> </p>
<h3 id="4-Results"><a href="#4-Results" class="headerlink" title="4. Results"></a>4. Results</h3><p>Figure 4 shows a result as we first glimpsed our output. In this bar chart, the x axis shows the day of week while the y axis shows an aggregate count of the empty taxis in a year for that day. It can be easily observed that Friday and Monday have more empty cabs than the other weekdays. In addition, the number of empty cabs in weekdays outnumbers those at weekends by a huge amount. This result makes sense in the way that there are much less taxis at weekends than in the weekdays.</p>
<p><img src="/img/by_day.png" alt="fig4" title="Empty Taxis Counts by Day of Week"></p>
<p><strong>Figure 4: Empty Taxis Counts by Day of Week</strong> </p>
<p>Figure 5 shows the count of empty cabs vs the hour of the day. Again, the y axis is the number of empty taxis in a year in a specific hour of the day. The bar chart shows that the amount of empty taxis reach peaks between 7AM to 10AM and between 7PM and 10PM.</p>
<p><img src="/img/by_hour.png" alt="fig5" title="Figure 5: Empty Taxis Counts by Hour of the Day"></p>
<p><strong>Figure 5: Empty Taxis Counts by Hour of the Day</strong> </p>
<p>The left chart in figure 6 shows a network we built by pysal and networkx while the right one shows the real taxi zones of NYC. By comparing the two graphs in figure 6, one can observe that pysal construct the edges of network based on if any of the two zones share borders.</p>
<p><img src="/img/taxi_zone.png" alt="fig6" title="Network of Taxi Zones (left); Real Map of Taxi Zone (right)"></p>
<p><strong>Figure 6: Network of Taxi Zones (left); Real Map of Taxi Zone (right)</strong> </p>
<p>Based on the network constructed, we calculated the path between the dropoff and pickup location. After that, we located the taxi zones across these paths and filtered out the zones with most empty cabs to make choropleth maps by 24 hour (figure 7), rush hour (figure 8), and offpeak hour (figure 9). These maps show that Midtown Manhattan and Astoria area have the most severe empty cabs problem (in either rush hours or idle hours). Comparing figure 8 and 9, one can see that there are many empty cabs in Northern Brooklyn during rush hours but there is far less of them during off-peak hours. Also, as expected, there are also some moderate empty cabs problem for areas with airports. However, the problem is generally worse during off-peak hours especially for the case of Newark Airport.</p>
<p><img src="/img/all_day.png" alt="fig7" title="Figure 7: Choropleth Map of Empty Taxis’ Distribution in 24 Hour"></p>
<p><strong>Figure 7: Choropleth Map of Empty Taxis’ Distribution in 24 Hour</strong></p>
<p><img src="/img/rush_hour.png" alt="fig8" title="Figure 8: Choropleth Map of Empty Taxis’ Distribution in Rush Hour"></p>
<p><strong>Figure 8: Choropleth Map of Empty Taxis’ Distribution in Rush Hour</strong></p>
<p><img src="/img/rush_hour.png" alt="fig9" title="Figure 9: Choropleth Map of Empty Taxis’ Distribution in Off-peak Hour"></p>
<p><strong>Figure 9: Choropleth Map of Empty Taxis’ Distribution in Off-peak Hour</strong></p>
<h3 id="5-Discussion"><a href="#5-Discussion" class="headerlink" title="5. Discussion"></a>5. Discussion</h3><p>As shown in figure 5, the amount of empty taxis reach peaks between 7AM to 10AM and between 7PM and 10PM. It maybe a bit counterintuitive since there should be rush hours in this two time windows. Our guess is that: there maybe more taxis in the rush hour. In addition, the peak is caused by traffic problem. Anothering interesting finding is that at 8AM, there is a dramatic decrease of empty cabs. We believe that this might correspond to the huge amount of commuting needs in the morning and that could be the reason why there are most empty taxis during 9AM and 10AM since most of the commuting jobs are finished.</p>
<p>From figure 7 to 9, we can conclude that Midtown Manhattan and Astoria area have the most severe empty taxis problem; additionally, airport areas also have some moderate empty taxis issue. These results generally reveals the fact that taxi zones with more traffic and potentially more taxi demands tend to have more empty taxis, which might be a reason why most taxi drivers do not want to leave from these areas. Nevertheless, it should be pointed out that these results are based on the simplified network constructed by PySal (edges were built according solely to the geographical distribution) while the real traffic conditions are much more complicated.</p>

  </section>

  
  
</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | 由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno">Huno</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
